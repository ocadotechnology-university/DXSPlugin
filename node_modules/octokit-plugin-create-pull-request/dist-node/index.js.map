<<<<<<< HEAD
{"version":3,"file":"index.js","sources":["../dist-src/value-to-tree-object.js","../dist-src/create-tree.js","../dist-src/create-commit.js","../dist-src/compose-create-pull-request.js","../dist-src/version.js","../dist-src/index.js"],"sourcesContent":["export async function valueToTreeObject(octokit, owner, repo, path, value) {\n    let mode = \"100644\";\n    if (value !== null && typeof value !== \"string\") {\n        mode = value.mode || mode;\n    }\n    // Text files can be changed through the .content key\n    if (typeof value === \"string\") {\n        return {\n            path,\n            mode: mode,\n            content: value,\n        };\n    }\n    // Binary files need to be created first using the git blob API,\n    // then changed by referencing in the .sha key\n    const { data } = await octokit.request(\"POST /repos/{owner}/{repo}/git/blobs\", {\n        owner,\n        repo,\n        ...value,\n    });\n    const blobSha = data.sha;\n    return {\n        path,\n        mode: mode,\n        sha: blobSha,\n    };\n}\n","import { valueToTreeObject } from \"./value-to-tree-object\";\nexport async function createTree(state, changes) {\n    const { octokit, owner, repo, ownerOrFork, latestCommitSha, latestCommitTreeSha, } = state;\n    const tree = (await Promise.all(Object.keys(changes.files).map(async (path) => {\n        const value = changes.files[path];\n        if (value === null) {\n            // Deleting a non-existent file from a tree leads to an \"GitRPC::BadObjectState\" error,\n            // so we only attempt to delete the file if it exists.\n            try {\n                // https://developer.github.com/v3/repos/contents/#get-contents\n                await octokit.request(\"HEAD /repos/{owner}/{repo}/contents/:path\", {\n                    owner: ownerOrFork,\n                    repo,\n                    ref: latestCommitSha,\n                    path,\n                });\n                return {\n                    path,\n                    mode: \"100644\",\n                    sha: null,\n                };\n            }\n            catch (error) {\n                return;\n            }\n        }\n        // When passed a function, retrieve the content of the file, pass it\n        // to the function, then return the result\n        if (typeof value === \"function\") {\n            let result;\n            try {\n                const { data: file } = await octokit.request(\"GET /repos/{owner}/{repo}/contents/:path\", {\n                    owner: ownerOrFork,\n                    repo,\n                    ref: latestCommitSha,\n                    path,\n                });\n                result = await value(Object.assign(file, { exists: true }));\n            }\n            catch (error) {\n                // istanbul ignore if\n                if (error.status !== 404)\n                    throw error;\n                // @ts-ignore\n                result = await value({ exists: false });\n            }\n            if (result === null || typeof result === \"undefined\")\n                return;\n            return valueToTreeObject(octokit, ownerOrFork, repo, path, result);\n        }\n        return valueToTreeObject(octokit, ownerOrFork, repo, path, value);\n    }))).filter(Boolean);\n    if (tree.length === 0) {\n        return null;\n    }\n    // https://developer.github.com/v3/git/trees/#create-a-tree\n    const { data: { sha: newTreeSha }, } = await octokit.request(\"POST /repos/{owner}/{repo}/git/trees\", {\n        owner: ownerOrFork,\n        repo,\n        base_tree: latestCommitTreeSha,\n        tree,\n    });\n    return newTreeSha;\n}\n","export async function createCommit(state, treeCreated, changes) {\n    const { octokit, repo, ownerOrFork, latestCommitSha } = state;\n    const message = treeCreated\n        ? changes.commit\n        : typeof changes.emptyCommit === \"string\"\n            ? changes.emptyCommit\n            : changes.commit;\n    // https://developer.github.com/v3/git/commits/#create-a-commit\n    const { data: latestCommit } = await octokit.request(\"POST /repos/{owner}/{repo}/git/commits\", {\n        owner: ownerOrFork,\n        repo,\n        message,\n        tree: state.latestCommitTreeSha,\n        parents: [latestCommitSha],\n    });\n    return latestCommit.sha;\n}\n","import { createTree } from \"./create-tree\";\nimport { createCommit } from \"./create-commit\";\nexport async function composeCreatePullRequest(octokit, { owner, repo, title, body, base, head, createWhenEmpty, changes: changesOption, draft = false, forceFork = false, update = false, }) {\n    const changes = Array.isArray(changesOption)\n        ? changesOption\n        : [changesOption];\n    if (changes.length === 0)\n        throw new Error('[octokit-plugin-create-pull-request] \"changes\" cannot be an empty array');\n    const state = { octokit, owner, repo };\n    // https://developer.github.com/v3/repos/#get-a-repository\n    const { data: repository, headers } = await octokit.request(\"GET /repos/{owner}/{repo}\", {\n        owner,\n        repo,\n    });\n    const isUser = !!headers[\"x-oauth-scopes\"];\n    if (!repository.permissions) {\n        throw new Error(\"[octokit-plugin-create-pull-request] Missing authentication\");\n    }\n    if (!base) {\n        base = repository.default_branch;\n    }\n    state.ownerOrFork = owner;\n    if (forceFork || (isUser && !repository.permissions.push)) {\n        // https://developer.github.com/v3/users/#get-the-authenticated-user\n        const user = await octokit.request(\"GET /user\");\n        // https://developer.github.com/v3/repos/forks/#list-forks\n        const forks = await octokit.request(\"GET /repos/{owner}/{repo}/forks\", {\n            owner,\n            repo,\n        });\n        const hasFork = forks.data.find(\n        /* istanbul ignore next - fork owner can be null, but we don't test that */\n        (fork) => fork.owner && fork.owner.login === user.data.login);\n        if (!hasFork) {\n            // https://developer.github.com/v3/repos/forks/#create-a-fork\n            await octokit.request(\"POST /repos/{owner}/{repo}/forks\", {\n                owner,\n                repo,\n            });\n        }\n        state.ownerOrFork = user.data.login;\n    }\n    // https://developer.github.com/v3/repos/commits/#list-commits-on-a-repository\n    const { data: [latestCommit], } = await octokit.request(\"GET /repos/{owner}/{repo}/commits\", {\n        owner,\n        repo,\n        sha: base,\n        per_page: 1,\n    });\n    state.latestCommitSha = latestCommit.sha;\n    state.latestCommitTreeSha = latestCommit.commit.tree.sha;\n    const baseCommitTreeSha = latestCommit.commit.tree.sha;\n    for (const change of changes) {\n        let treeCreated = false;\n        if (change.files && Object.keys(change.files).length) {\n            const latestCommitTreeSha = await createTree(state, change);\n            if (latestCommitTreeSha) {\n                state.latestCommitTreeSha = latestCommitTreeSha;\n                treeCreated = true;\n            }\n        }\n        if (treeCreated || change.emptyCommit !== false) {\n            state.latestCommitSha = await createCommit(state, treeCreated, change);\n        }\n    }\n    const hasNoChanges = baseCommitTreeSha === state.latestCommitTreeSha;\n    if (hasNoChanges && createWhenEmpty === false) {\n        return null;\n    }\n    const branchInfo = await octokit.graphql(`\n    query ($owner: String!, $repo: String!, $head: String!) {\n      repository(name: $repo, owner: $owner) {\n        ref(qualifiedName: $head) {\n          associatedPullRequests(first: 1, states: OPEN) {\n            edges {\n              node {\n                id\n                number\n                url\n              }\n            }\n          }\n        }\n      }\n    }`, {\n        owner: state.ownerOrFork,\n        repo,\n        head,\n    });\n    const branchExists = !!branchInfo.repository.ref;\n    const existingPullRequest = branchInfo.repository.ref?.associatedPullRequests?.edges?.[0]?.node;\n    if (existingPullRequest && !update) {\n        throw new Error(`[octokit-plugin-create-pull-request] Pull request already exists: ${existingPullRequest.url}. Set update=true to enable updating`);\n    }\n    if (branchExists) {\n        // https://docs.github.com/en/rest/git/refs#update-a-reference\n        await octokit.request(\"PATCH /repos/{owner}/{repo}/git/refs/{ref}\", {\n            owner: state.ownerOrFork,\n            repo,\n            sha: state.latestCommitSha,\n            ref: `heads/${head}`,\n            force: true,\n        });\n    }\n    else {\n        // https://developer.github.com/v3/git/refs/#create-a-reference\n        await octokit.request(\"POST /repos/{owner}/{repo}/git/refs\", {\n            owner: state.ownerOrFork,\n            repo,\n            sha: state.latestCommitSha,\n            ref: `refs/heads/${head}`,\n        });\n    }\n    const pullRequestOptions = {\n        owner,\n        repo,\n        head: `${state.ownerOrFork}:${head}`,\n        base,\n        title,\n        body,\n        draft,\n    };\n    if (existingPullRequest) {\n        // https://docs.github.com/en/rest/pulls/pulls#update-a-pull-request\n        return await octokit.request(\"PATCH /repos/{owner}/{repo}/pulls/{pull_number}\", {\n            pull_number: existingPullRequest.number,\n            ...pullRequestOptions,\n        });\n    }\n    else {\n        // https://developer.github.com/v3/pulls/#create-a-pull-request\n        return await octokit.request(\"POST /repos/{owner}/{repo}/pulls\", pullRequestOptions);\n    }\n}\n","export const VERSION = \"3.13.1\";\n","import { composeCreatePullRequest } from \"./compose-create-pull-request\";\nimport { VERSION } from \"./version\";\n/**\n * @param octokit Octokit instance\n */\nexport function createPullRequest(octokit) {\n    return {\n        createPullRequest: composeCreatePullRequest.bind(null, octokit),\n    };\n}\nexport { composeCreatePullRequest } from \"./compose-create-pull-request\";\ncreatePullRequest.VERSION = VERSION;\n"],"names":["valueToTreeObject","octokit","owner","repo","path","value","mode","content","data","request","blobSha","sha","createTree","state","changes","ownerOrFork","latestCommitSha","latestCommitTreeSha","tree","Promise","all","Object","keys","files","map","ref","error","result","file","assign","exists","status","filter","Boolean","length","newTreeSha","base_tree","createCommit","treeCreated","message","commit","emptyCommit","latestCommit","parents","composeCreatePullRequest","title","body","base","head","createWhenEmpty","changesOption","draft","forceFork","update","Array","isArray","Error","repository","headers","isUser","permissions","default_branch","push","user","forks","hasFork","find","fork","login","per_page","baseCommitTreeSha","change","hasNoChanges","branchInfo","graphql","branchExists","existingPullRequest","associatedPullRequests","edges","node","url","force","pullRequestOptions","pull_number","number","VERSION","createPullRequest","bind"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,eAAeA,iBAAf,CAAiCC,OAAjC,EAA0CC,KAA1C,EAAiDC,IAAjD,EAAuDC,IAAvD,EAA6DC,KAA7D,EAAoE;AACvE,MAAIC,IAAI,GAAG,QAAX;;AACA,MAAID,KAAK,KAAK,IAAV,IAAkB,OAAOA,KAAP,KAAiB,QAAvC,EAAiD;AAC7CC,IAAAA,IAAI,GAAGD,KAAK,CAACC,IAAN,IAAcA,IAArB;AACH,GAJsE;;;AAMvE,MAAI,OAAOD,KAAP,KAAiB,QAArB,EAA+B;AAC3B,WAAO;AACHD,MAAAA,IADG;AAEHE,MAAAA,IAAI,EAAEA,IAFH;AAGHC,MAAAA,OAAO,EAAEF;AAHN,KAAP;AAKH,GAZsE;AAcvE;;;AACA,QAAM;AAAEG,IAAAA;AAAF,MAAW,MAAMP,OAAO,CAACQ,OAAR,CAAgB,sCAAhB;AACnBP,IAAAA,KADmB;AAEnBC,IAAAA;AAFmB,KAGhBE,KAHgB,EAAvB;AAKA,QAAMK,OAAO,GAAGF,IAAI,CAACG,GAArB;AACA,SAAO;AACHP,IAAAA,IADG;AAEHE,IAAAA,IAAI,EAAEA,IAFH;AAGHK,IAAAA,GAAG,EAAED;AAHF,GAAP;AAKH;;ACzBM,eAAeE,UAAf,CAA0BC,KAA1B,EAAiCC,OAAjC,EAA0C;AAC7C,QAAM;AAAEb,IAAAA,OAAF;AAAWC,IAAAA,KAAX;AAAkBC,IAAAA,IAAlB;AAAwBY,IAAAA,WAAxB;AAAqCC,IAAAA,eAArC;AAAsDC,IAAAA;AAAtD,MAA+EJ,KAArF;AACA,QAAMK,IAAI,GAAG,CAAC,MAAMC,OAAO,CAACC,GAAR,CAAYC,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACS,KAApB,EAA2BC,GAA3B,CAA+B,MAAOpB,IAAP,IAAgB;AAC3E,UAAMC,KAAK,GAAGS,OAAO,CAACS,KAAR,CAAcnB,IAAd,CAAd;;AACA,QAAIC,KAAK,KAAK,IAAd,EAAoB;AAChB;AACA;AACA,UAAI;AACA;AACA,cAAMJ,OAAO,CAACQ,OAAR,CAAgB,2CAAhB,EAA6D;AAC/DP,UAAAA,KAAK,EAAEa,WADwD;AAE/DZ,UAAAA,IAF+D;AAG/DsB,UAAAA,GAAG,EAAET,eAH0D;AAI/DZ,UAAAA;AAJ+D,SAA7D,CAAN;AAMA,eAAO;AACHA,UAAAA,IADG;AAEHE,UAAAA,IAAI,EAAE,QAFH;AAGHK,UAAAA,GAAG,EAAE;AAHF,SAAP;AAKH,OAbD,CAcA,OAAOe,KAAP,EAAc;AACV;AACH;AACJ,KAtB0E;AAwB3E;;;AACA,QAAI,OAAOrB,KAAP,KAAiB,UAArB,EAAiC;AAC7B,UAAIsB,MAAJ;;AACA,UAAI;AACA,cAAM;AAAEnB,UAAAA,IAAI,EAAEoB;AAAR,YAAiB,MAAM3B,OAAO,CAACQ,OAAR,CAAgB,0CAAhB,EAA4D;AACrFP,UAAAA,KAAK,EAAEa,WAD8E;AAErFZ,UAAAA,IAFqF;AAGrFsB,UAAAA,GAAG,EAAET,eAHgF;AAIrFZ,UAAAA;AAJqF,SAA5D,CAA7B;AAMAuB,QAAAA,MAAM,GAAG,MAAMtB,KAAK,CAACgB,MAAM,CAACQ,MAAP,CAAcD,IAAd,EAAoB;AAAEE,UAAAA,MAAM,EAAE;AAAV,SAApB,CAAD,CAApB;AACH,OARD,CASA,OAAOJ,KAAP,EAAc;AACV;AACA,YAAIA,KAAK,CAACK,MAAN,KAAiB,GAArB,EACI,MAAML,KAAN,CAHM;;AAKVC,QAAAA,MAAM,GAAG,MAAMtB,KAAK,CAAC;AAAEyB,UAAAA,MAAM,EAAE;AAAV,SAAD,CAApB;AACH;;AACD,UAAIH,MAAM,KAAK,IAAX,IAAmB,OAAOA,MAAP,KAAkB,WAAzC,EACI;AACJ,aAAO3B,iBAAiB,CAACC,OAAD,EAAUc,WAAV,EAAuBZ,IAAvB,EAA6BC,IAA7B,EAAmCuB,MAAnC,CAAxB;AACH;;AACD,WAAO3B,iBAAiB,CAACC,OAAD,EAAUc,WAAV,EAAuBZ,IAAvB,EAA6BC,IAA7B,EAAmCC,KAAnC,CAAxB;AACH,GAhD+B,CAAZ,CAAP,EAgDR2B,MAhDQ,CAgDDC,OAhDC,CAAb;;AAiDA,MAAIf,IAAI,CAACgB,MAAL,KAAgB,CAApB,EAAuB;AACnB,WAAO,IAAP;AACH,GArD4C;;;AAuD7C,QAAM;AAAE1B,IAAAA,IAAI,EAAE;AAAEG,MAAAA,GAAG,EAAEwB;AAAP;AAAR,MAAiC,MAAMlC,OAAO,CAACQ,OAAR,CAAgB,sCAAhB,EAAwD;AACjGP,IAAAA,KAAK,EAAEa,WAD0F;AAEjGZ,IAAAA,IAFiG;AAGjGiC,IAAAA,SAAS,EAAEnB,mBAHsF;AAIjGC,IAAAA;AAJiG,GAAxD,CAA7C;AAMA,SAAOiB,UAAP;AACH;;AC/DM,eAAeE,YAAf,CAA4BxB,KAA5B,EAAmCyB,WAAnC,EAAgDxB,OAAhD,EAAyD;AAC5D,QAAM;AAAEb,IAAAA,OAAF;AAAWE,IAAAA,IAAX;AAAiBY,IAAAA,WAAjB;AAA8BC,IAAAA;AAA9B,MAAkDH,KAAxD;AACA,QAAM0B,OAAO,GAAGD,WAAW,GACrBxB,OAAO,CAAC0B,MADa,GAErB,OAAO1B,OAAO,CAAC2B,WAAf,KAA+B,QAA/B,GACI3B,OAAO,CAAC2B,WADZ,GAEI3B,OAAO,CAAC0B,MAJlB,CAF4D;;AAQ5D,QAAM;AAAEhC,IAAAA,IAAI,EAAEkC;AAAR,MAAyB,MAAMzC,OAAO,CAACQ,OAAR,CAAgB,wCAAhB,EAA0D;AAC3FP,IAAAA,KAAK,EAAEa,WADoF;AAE3FZ,IAAAA,IAF2F;AAG3FoC,IAAAA,OAH2F;AAI3FrB,IAAAA,IAAI,EAAEL,KAAK,CAACI,mBAJ+E;AAK3F0B,IAAAA,OAAO,EAAE,CAAC3B,eAAD;AALkF,GAA1D,CAArC;AAOA,SAAO0B,YAAY,CAAC/B,GAApB;AACH;;ACdM,eAAeiC,wBAAf,CAAwC3C,OAAxC,EAAiD;AAAEC,EAAAA,KAAF;AAASC,EAAAA,IAAT;AAAe0C,EAAAA,KAAf;AAAsBC,EAAAA,IAAtB;AAA4BC,EAAAA,IAA5B;AAAkCC,EAAAA,IAAlC;AAAwCC,EAAAA,eAAxC;AAAyDnC,EAAAA,OAAO,EAAEoC,aAAlE;AAAiFC,EAAAA,KAAK,GAAG,KAAzF;AAAgGC,EAAAA,SAAS,GAAG,KAA5G;AAAmHC,EAAAA,MAAM,GAAG;AAA5H,CAAjD,EAAuL;AAAA;;AAC1L,QAAMvC,OAAO,GAAGwC,KAAK,CAACC,OAAN,CAAcL,aAAd,IACVA,aADU,GAEV,CAACA,aAAD,CAFN;AAGA,MAAIpC,OAAO,CAACoB,MAAR,KAAmB,CAAvB,EACI,MAAM,IAAIsB,KAAJ,CAAU,yEAAV,CAAN;AACJ,QAAM3C,KAAK,GAAG;AAAEZ,IAAAA,OAAF;AAAWC,IAAAA,KAAX;AAAkBC,IAAAA;AAAlB,GAAd,CAN0L;;AAQ1L,QAAM;AAAEK,IAAAA,IAAI,EAAEiD,UAAR;AAAoBC,IAAAA;AAApB,MAAgC,MAAMzD,OAAO,CAACQ,OAAR,CAAgB,2BAAhB,EAA6C;AACrFP,IAAAA,KADqF;AAErFC,IAAAA;AAFqF,GAA7C,CAA5C;AAIA,QAAMwD,MAAM,GAAG,CAAC,CAACD,OAAO,CAAC,gBAAD,CAAxB;;AACA,MAAI,CAACD,UAAU,CAACG,WAAhB,EAA6B;AACzB,UAAM,IAAIJ,KAAJ,CAAU,6DAAV,CAAN;AACH;;AACD,MAAI,CAACT,IAAL,EAAW;AACPA,IAAAA,IAAI,GAAGU,UAAU,CAACI,cAAlB;AACH;;AACDhD,EAAAA,KAAK,CAACE,WAAN,GAAoBb,KAApB;;AACA,MAAIkD,SAAS,IAAKO,MAAM,IAAI,CAACF,UAAU,CAACG,WAAX,CAAuBE,IAApD,EAA2D;AACvD;AACA,UAAMC,IAAI,GAAG,MAAM9D,OAAO,CAACQ,OAAR,CAAgB,WAAhB,CAAnB,CAFuD;;AAIvD,UAAMuD,KAAK,GAAG,MAAM/D,OAAO,CAACQ,OAAR,CAAgB,iCAAhB,EAAmD;AACnEP,MAAAA,KADmE;AAEnEC,MAAAA;AAFmE,KAAnD,CAApB;AAIA,UAAM8D,OAAO,GAAGD,KAAK,CAACxD,IAAN,CAAW0D,IAAX;AAChB;AACCC,IAAAA,IAAD,IAAUA,IAAI,CAACjE,KAAL,IAAciE,IAAI,CAACjE,KAAL,CAAWkE,KAAX,KAAqBL,IAAI,CAACvD,IAAL,CAAU4D,KAFvC,CAAhB;;AAGA,QAAI,CAACH,OAAL,EAAc;AACV;AACA,YAAMhE,OAAO,CAACQ,OAAR,CAAgB,kCAAhB,EAAoD;AACtDP,QAAAA,KADsD;AAEtDC,QAAAA;AAFsD,OAApD,CAAN;AAIH;;AACDU,IAAAA,KAAK,CAACE,WAAN,GAAoBgD,IAAI,CAACvD,IAAL,CAAU4D,KAA9B;AACH,GAvCyL;;;AAyC1L,QAAM;AAAE5D,IAAAA,IAAI,EAAE,CAACkC,YAAD;AAAR,MAA4B,MAAMzC,OAAO,CAACQ,OAAR,CAAgB,mCAAhB,EAAqD;AACzFP,IAAAA,KADyF;AAEzFC,IAAAA,IAFyF;AAGzFQ,IAAAA,GAAG,EAAEoC,IAHoF;AAIzFsB,IAAAA,QAAQ,EAAE;AAJ+E,GAArD,CAAxC;AAMAxD,EAAAA,KAAK,CAACG,eAAN,GAAwB0B,YAAY,CAAC/B,GAArC;AACAE,EAAAA,KAAK,CAACI,mBAAN,GAA4ByB,YAAY,CAACF,MAAb,CAAoBtB,IAApB,CAAyBP,GAArD;AACA,QAAM2D,iBAAiB,GAAG5B,YAAY,CAACF,MAAb,CAAoBtB,IAApB,CAAyBP,GAAnD;;AACA,OAAK,MAAM4D,MAAX,IAAqBzD,OAArB,EAA8B;AAC1B,QAAIwB,WAAW,GAAG,KAAlB;;AACA,QAAIiC,MAAM,CAAChD,KAAP,IAAgBF,MAAM,CAACC,IAAP,CAAYiD,MAAM,CAAChD,KAAnB,EAA0BW,MAA9C,EAAsD;AAClD,YAAMjB,mBAAmB,GAAG,MAAML,UAAU,CAACC,KAAD,EAAQ0D,MAAR,CAA5C;;AACA,UAAItD,mBAAJ,EAAyB;AACrBJ,QAAAA,KAAK,CAACI,mBAAN,GAA4BA,mBAA5B;AACAqB,QAAAA,WAAW,GAAG,IAAd;AACH;AACJ;;AACD,QAAIA,WAAW,IAAIiC,MAAM,CAAC9B,WAAP,KAAuB,KAA1C,EAAiD;AAC7C5B,MAAAA,KAAK,CAACG,eAAN,GAAwB,MAAMqB,YAAY,CAACxB,KAAD,EAAQyB,WAAR,EAAqBiC,MAArB,CAA1C;AACH;AACJ;;AACD,QAAMC,YAAY,GAAGF,iBAAiB,KAAKzD,KAAK,CAACI,mBAAjD;;AACA,MAAIuD,YAAY,IAAIvB,eAAe,KAAK,KAAxC,EAA+C;AAC3C,WAAO,IAAP;AACH;;AACD,QAAMwB,UAAU,GAAG,MAAMxE,OAAO,CAACyE,OAAR,CAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAf6B,EAerB;AACAxE,IAAAA,KAAK,EAAEW,KAAK,CAACE,WADb;AAEAZ,IAAAA,IAFA;AAGA6C,IAAAA;AAHA,GAfqB,CAAzB;AAoBA,QAAM2B,YAAY,GAAG,CAAC,CAACF,UAAU,CAAChB,UAAX,CAAsBhC,GAA7C;AACA,QAAMmD,mBAAmB,4BAAGH,UAAU,CAAChB,UAAX,CAAsBhC,GAAzB,oFAAG,sBAA2BoD,sBAA9B,qFAAG,uBAAmDC,KAAtD,qFAAG,uBAA2D,CAA3D,CAAH,2DAAG,uBAA+DC,IAA3F;;AACA,MAAIH,mBAAmB,IAAI,CAACvB,MAA5B,EAAoC;AAChC,UAAM,IAAIG,KAAJ,CAAW,qEAAoEoB,mBAAmB,CAACI,GAAI,sCAAvG,CAAN;AACH;;AACD,MAAIL,YAAJ,EAAkB;AACd;AACA,UAAM1E,OAAO,CAACQ,OAAR,CAAgB,4CAAhB,EAA8D;AAChEP,MAAAA,KAAK,EAAEW,KAAK,CAACE,WADmD;AAEhEZ,MAAAA,IAFgE;AAGhEQ,MAAAA,GAAG,EAAEE,KAAK,CAACG,eAHqD;AAIhES,MAAAA,GAAG,EAAG,SAAQuB,IAAK,EAJ6C;AAKhEiC,MAAAA,KAAK,EAAE;AALyD,KAA9D,CAAN;AAOH,GATD,MAUK;AACD;AACA,UAAMhF,OAAO,CAACQ,OAAR,CAAgB,qCAAhB,EAAuD;AACzDP,MAAAA,KAAK,EAAEW,KAAK,CAACE,WAD4C;AAEzDZ,MAAAA,IAFyD;AAGzDQ,MAAAA,GAAG,EAAEE,KAAK,CAACG,eAH8C;AAIzDS,MAAAA,GAAG,EAAG,cAAauB,IAAK;AAJiC,KAAvD,CAAN;AAMH;;AACD,QAAMkC,kBAAkB,GAAG;AACvBhF,IAAAA,KADuB;AAEvBC,IAAAA,IAFuB;AAGvB6C,IAAAA,IAAI,EAAG,GAAEnC,KAAK,CAACE,WAAY,IAAGiC,IAAK,EAHZ;AAIvBD,IAAAA,IAJuB;AAKvBF,IAAAA,KALuB;AAMvBC,IAAAA,IANuB;AAOvBK,IAAAA;AAPuB,GAA3B;;AASA,MAAIyB,mBAAJ,EAAyB;AACrB;AACA,WAAO,MAAM3E,OAAO,CAACQ,OAAR,CAAgB,iDAAhB;AACT0E,MAAAA,WAAW,EAAEP,mBAAmB,CAACQ;AADxB,OAENF,kBAFM,EAAb;AAIH,GAND,MAOK;AACD;AACA,WAAO,MAAMjF,OAAO,CAACQ,OAAR,CAAgB,kCAAhB,EAAoDyE,kBAApD,CAAb;AACH;AACJ;;ACrIM,MAAMG,OAAO,GAAG,mBAAhB;;ACEP;AACA;AACA;;AACA,AAAO,SAASC,iBAAT,CAA2BrF,OAA3B,EAAoC;AACvC,SAAO;AACHqF,IAAAA,iBAAiB,EAAE1C,wBAAwB,CAAC2C,IAAzB,CAA8B,IAA9B,EAAoCtF,OAApC;AADhB,GAAP;AAGH;AACD,AACAqF,iBAAiB,CAACD,OAAlB,GAA4BA,OAA5B;;;;;"}
=======
{"version":3,"file":"index.js","sources":["../dist-src/value-to-tree-object.js","../dist-src/constants.js","../dist-src/create-tree.js","../dist-src/create-commit.js","../dist-src/compose-create-pull-request.js","../dist-src/version.js","../dist-src/index.js"],"sourcesContent":["export async function valueToTreeObject(octokit, owner, repo, path, value) {\n    const defaultMode = \"100644\";\n    // Text files can be changed through the .content key\n    if (typeof value === \"string\") {\n        return {\n            path,\n            mode: defaultMode,\n            content: value,\n        };\n    }\n    const mode = value.mode ?? defaultMode;\n    // UTF-8 files can be treated as text files\n    // https://github.com/gr2m/octokit-plugin-create-pull-request/pull/133\n    if (value.encoding === \"utf-8\") {\n        return {\n            path,\n            mode: mode,\n            content: value.content,\n        };\n    }\n    // Binary files need to be created first using the git blob API,\n    // then changed by referencing in the .sha key\n    const { data } = await octokit.request(\"POST /repos/{owner}/{repo}/git/blobs\", {\n        owner,\n        repo,\n        ...value,\n    });\n    const blobSha = data.sha;\n    return {\n        path,\n        mode: mode,\n        sha: blobSha,\n    };\n}\n","export const DELETE_FILE = Symbol(\"DELETE_FILE\");\n","import { valueToTreeObject } from \"./value-to-tree-object\";\nimport { DELETE_FILE } from \"./constants\";\nexport async function createTree(state, changes) {\n    const { octokit, owner, repo, ownerOrFork, latestCommitSha, latestCommitTreeSha, } = state;\n    let tree = [];\n    for (const path of Object.keys(changes.files)) {\n        const value = changes.files[path];\n        if (value === DELETE_FILE) {\n            // Deleting a non-existent file from a tree leads to an \"GitRPC::BadObjectState\" error,\n            // so we only attempt to delete the file if it exists.\n            try {\n                // https://developer.github.com/v3/repos/contents/#get-contents\n                await octokit.request(\"HEAD /repos/{owner}/{repo}/contents/:path\", {\n                    owner: ownerOrFork,\n                    repo,\n                    ref: latestCommitSha,\n                    path,\n                });\n                tree.push({\n                    path,\n                    mode: \"100644\",\n                    sha: null,\n                });\n                continue;\n            }\n            catch (error) {\n                continue;\n            }\n        }\n        // When passed a function, retrieve the content of the file, pass it\n        // to the function, then return the result\n        if (typeof value === \"function\") {\n            let result;\n            try {\n                const { data: file } = await octokit.request(\"GET /repos/{owner}/{repo}/contents/:path\", {\n                    owner: ownerOrFork,\n                    repo,\n                    ref: latestCommitSha,\n                    path,\n                });\n                result = await value(Object.assign(file, { exists: true }));\n                if (result === DELETE_FILE) {\n                    try {\n                        // https://developer.github.com/v3/repos/contents/#get-contents\n                        await octokit.request(\"HEAD /repos/{owner}/{repo}/contents/:path\", {\n                            owner: ownerOrFork,\n                            repo,\n                            ref: latestCommitSha,\n                            path,\n                        });\n                        tree.push({\n                            path,\n                            mode: \"100644\",\n                            sha: null,\n                        });\n                        continue;\n                    }\n                    catch (error) {\n                        // istanbul ignore next\n                        continue;\n                    }\n                }\n            }\n            catch (error) {\n                // @ts-ignore\n                // istanbul ignore if\n                if (error.status !== 404)\n                    throw error;\n                // @ts-ignore\n                result = await value({ exists: false });\n            }\n            if (result === null ||\n                typeof result === \"undefined\" ||\n                typeof result === \"symbol\") {\n                continue;\n            }\n            tree.push(\n            // @ts-expect-error - Argument result can never be of type Symbol at this branch\n            // because the above condition will catch it and move on to the next iteration cycle\n            await valueToTreeObject(octokit, ownerOrFork, repo, path, result));\n            continue;\n        }\n        // @ts-expect-error - Argument value can never be of type Symbol at this branch\n        // because the above condition will catch it and initiate a file deletion operation\n        tree.push(await valueToTreeObject(octokit, ownerOrFork, repo, path, value));\n        continue;\n    }\n    tree = tree.filter(Boolean);\n    if (tree.length === 0) {\n        return null;\n    }\n    // https://developer.github.com/v3/git/trees/#create-a-tree\n    const { data: { sha: newTreeSha }, } = await octokit.request(\"POST /repos/{owner}/{repo}/git/trees\", {\n        owner: ownerOrFork,\n        repo,\n        base_tree: latestCommitTreeSha,\n        tree,\n    });\n    return newTreeSha;\n}\n","export async function createCommit(state, treeCreated, changes) {\n    const { octokit, repo, ownerOrFork, latestCommitSha } = state;\n    const message = treeCreated\n        ? changes.commit\n        : typeof changes.emptyCommit === \"string\"\n            ? changes.emptyCommit\n            : changes.commit;\n    const commit = {\n        message,\n        author: changes.author,\n        committer: changes.committer,\n        tree: state.latestCommitTreeSha,\n        parents: [latestCommitSha],\n    };\n    // https://developer.github.com/v3/git/commits/#create-a-commit\n    const { data: latestCommit } = await octokit.request(\"POST /repos/{owner}/{repo}/git/commits\", {\n        owner: ownerOrFork,\n        repo,\n        ...commit,\n        signature: changes.signature\n            ? await changes.signature(commit)\n            : undefined,\n    });\n    return latestCommit.sha;\n}\n","import { createTree } from \"./create-tree\";\nimport { createCommit } from \"./create-commit\";\nexport async function composeCreatePullRequest(octokit, { owner, repo, title, body, base, head, createWhenEmpty, changes: changesOption, draft = false, labels = [], forceFork = false, update = false, }) {\n    if (head === base) {\n        throw new Error('[octokit-plugin-create-pull-request] \"head\" cannot be the same value as \"base\"');\n    }\n    const changes = Array.isArray(changesOption)\n        ? changesOption\n        : [changesOption];\n    if (changes.length === 0)\n        throw new Error('[octokit-plugin-create-pull-request] \"changes\" cannot be an empty array');\n    const state = { octokit, owner, repo };\n    // https://developer.github.com/v3/repos/#get-a-repository\n    const { data: repository, headers } = await octokit.request(\"GET /repos/{owner}/{repo}\", {\n        owner,\n        repo,\n    });\n    const isUser = !!headers[\"x-oauth-scopes\"];\n    if (!repository.permissions) {\n        throw new Error(\"[octokit-plugin-create-pull-request] Missing authentication\");\n    }\n    if (!base) {\n        base = repository.default_branch;\n    }\n    state.ownerOrFork = owner;\n    if (forceFork || (isUser && !repository.permissions.push)) {\n        // https://developer.github.com/v3/users/#get-the-authenticated-user\n        const user = await octokit.request(\"GET /user\");\n        // https://developer.github.com/v3/repos/forks/#list-forks\n        const forks = await octokit.request(\"GET /repos/{owner}/{repo}/forks\", {\n            owner,\n            repo,\n        });\n        const hasFork = forks.data.find(\n        /* istanbul ignore next - fork owner can be null, but we don't test that */\n        (fork) => fork.owner && fork.owner.login === user.data.login);\n        if (!hasFork) {\n            // https://developer.github.com/v3/repos/forks/#create-a-fork\n            await octokit.request(\"POST /repos/{owner}/{repo}/forks\", {\n                owner,\n                repo,\n            });\n        }\n        state.ownerOrFork = user.data.login;\n    }\n    // https://developer.github.com/v3/repos/commits/#list-commits-on-a-repository\n    const { data: [latestCommit], } = await octokit.request(\"GET /repos/{owner}/{repo}/commits\", {\n        owner,\n        repo,\n        sha: base,\n        per_page: 1,\n    });\n    state.latestCommitSha = latestCommit.sha;\n    state.latestCommitTreeSha = latestCommit.commit.tree.sha;\n    const baseCommitTreeSha = latestCommit.commit.tree.sha;\n    for (const change of changes) {\n        let treeCreated = false;\n        if (change.files && Object.keys(change.files).length) {\n            const latestCommitTreeSha = await createTree(state, change);\n            if (latestCommitTreeSha) {\n                state.latestCommitTreeSha = latestCommitTreeSha;\n                treeCreated = true;\n            }\n        }\n        if (treeCreated || change.emptyCommit !== false) {\n            state.latestCommitSha = await createCommit(state, treeCreated, change);\n        }\n    }\n    const hasNoChanges = baseCommitTreeSha === state.latestCommitTreeSha;\n    if (hasNoChanges && createWhenEmpty === false) {\n        return null;\n    }\n    const branchInfo = await octokit.graphql(`\n    query ($owner: String!, $repo: String!, $head: String!) {\n      repository(name: $repo, owner: $owner) {\n        ref(qualifiedName: $head) {\n          associatedPullRequests(first: 1, states: OPEN) {\n            edges {\n              node {\n                id\n                number\n                url\n              }\n            }\n          }\n        }\n      }\n    }`, {\n        owner: state.ownerOrFork,\n        repo,\n        head,\n    });\n    const branchExists = !!branchInfo.repository.ref;\n    const existingPullRequest = branchInfo.repository.ref?.associatedPullRequests?.edges?.[0]?.node;\n    if (existingPullRequest && !update) {\n        throw new Error(`[octokit-plugin-create-pull-request] Pull request already exists: ${existingPullRequest.url}. Set update=true to enable updating`);\n    }\n    if (branchExists) {\n        // https://docs.github.com/en/rest/git/refs#update-a-reference\n        await octokit.request(\"PATCH /repos/{owner}/{repo}/git/refs/{ref}\", {\n            owner: state.ownerOrFork,\n            repo,\n            sha: state.latestCommitSha,\n            ref: `heads/${head}`,\n            force: true,\n        });\n    }\n    else {\n        // https://developer.github.com/v3/git/refs/#create-a-reference\n        await octokit.request(\"POST /repos/{owner}/{repo}/git/refs\", {\n            owner: state.ownerOrFork,\n            repo,\n            sha: state.latestCommitSha,\n            ref: `refs/heads/${head}`,\n        });\n    }\n    const pullRequestOptions = {\n        owner,\n        repo,\n        head: `${state.ownerOrFork}:${head}`,\n        base,\n        title,\n        body,\n        draft,\n    };\n    let res;\n    if (existingPullRequest) {\n        // https://docs.github.com/en/rest/pulls/pulls#update-a-pull-request\n        res = await octokit.request(\"PATCH /repos/{owner}/{repo}/pulls/{pull_number}\", {\n            pull_number: existingPullRequest.number,\n            ...pullRequestOptions,\n        });\n    }\n    else {\n        // https://developer.github.com/v3/pulls/#create-a-pull-request\n        res = await octokit.request(\"POST /repos/{owner}/{repo}/pulls\", pullRequestOptions);\n    }\n    if (labels.length) {\n        try {\n            const labelRes = await octokit.request(\"POST /repos/{owner}/{repo}/issues/{number}/labels\", {\n                owner,\n                repo,\n                number: res.data.number,\n                labels,\n            });\n            // istanbul ignore if\n            if (labelRes.data.length > labels.length) {\n                octokit.log.warn(\"The pull request already contains more labels than the ones provided. This could be due to the presence of previous labels.\");\n            }\n        }\n        catch (error) {\n            // @ts-ignore\n            // istanbul ignore if\n            if (error.status === 403) {\n                octokit.log.warn(\"You do not have permissions to apply labels to this pull request. However, the pull request has been successfully created without the requested labels.\");\n                return res;\n            }\n            // @ts-ignore\n            if (error.status !== 403)\n                throw error;\n        }\n    }\n    return res;\n}\n","export const VERSION = \"5.1.1\";\n","import { composeCreatePullRequest } from \"./compose-create-pull-request\";\nimport { VERSION } from \"./version\";\nexport { DELETE_FILE } from \"./constants\";\n/**\n * @param octokit Octokit instance\n */\nexport function createPullRequest(octokit) {\n    return {\n        createPullRequest: composeCreatePullRequest.bind(null, octokit),\n    };\n}\nexport { composeCreatePullRequest } from \"./compose-create-pull-request\";\ncreatePullRequest.VERSION = VERSION;\n"],"names":["valueToTreeObject","octokit","owner","repo","path","value","defaultMode","mode","content","encoding","data","request","blobSha","sha","DELETE_FILE","Symbol","createTree","state","changes","ownerOrFork","latestCommitSha","latestCommitTreeSha","tree","Object","keys","files","ref","push","error","result","file","assign","exists","status","filter","Boolean","length","newTreeSha","base_tree","createCommit","treeCreated","message","commit","emptyCommit","author","committer","parents","latestCommit","signature","undefined","composeCreatePullRequest","title","body","base","head","createWhenEmpty","changesOption","draft","labels","forceFork","update","Error","Array","isArray","repository","headers","isUser","permissions","default_branch","user","forks","hasFork","find","fork","login","per_page","baseCommitTreeSha","change","hasNoChanges","branchInfo","graphql","branchExists","existingPullRequest","associatedPullRequests","edges","node","url","force","pullRequestOptions","res","pull_number","number","labelRes","log","warn","VERSION","createPullRequest","bind"],"mappings":"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"}
>>>>>>> master
