"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4858],{43889:(j,v,o)=>{o.d(v,{A:()=>z,C:()=>Ee,a:()=>G});var t=o(14041),f=o(64947),y=o(58837),_=o(72501),P=o(67720),D=o(8109),M=o(91467),h=o(5951),L=o(69621),R=o(58007),A=o(6365),B=o(23180),K=o(52950),W=o(40477),$=o(29835),U=o(4387),p=o(48821),H=o(91638);const x={collapsed:!0,numVisitsOpen:3,numVisitsTotal:8,visits:[],loading:!0,kind:"recent"},k={...x,setCollapsed:()=>{},setNumVisitsOpen:()=>{},setNumVisitsTotal:()=>{},setVisits:()=>{},setLoading:()=>{},setKind:()=>{},setContext:()=>{}},V=(0,t.createContext)(k),C=(e,a)=>n=>e(r=>({...r,[a]:typeof n=="function"?n(r[a]):n})),G=({children:e})=>{const[a,n]=t.useState(x),{setCollapsed:r,setNumVisitsOpen:l,setNumVisitsTotal:s,setVisits:E,setLoading:u,setKind:c}=(0,t.useMemo)(()=>({setCollapsed:C(n,"collapsed"),setNumVisitsOpen:C(n,"numVisitsOpen"),setNumVisitsTotal:C(n,"numVisitsTotal"),setVisits:C(n,"visits"),setLoading:C(n,"loading"),setKind:C(n,"kind")}),[n]),i={...a,setContext:n,setCollapsed:r,setNumVisitsOpen:l,setNumVisitsTotal:s,setVisits:E,setLoading:u,setKind:c};return t.createElement(V.Provider,{value:i},e)},I=()=>{const e=t.useContext(V);if(e===void 0)throw new Error("VisitedByType useContext found undefined ContextValue, <ContextProvider/> could be missing");return e},z=()=>{const{collapsed:e,setCollapsed:a,visits:n,numVisitsOpen:r,loading:l}=I(),s=(0,t.useCallback)(()=>a(u=>!u),[a]),E=e?"View More":"View Less";return!l&&n.length<=r?t.createElement(t.Fragment,null):t.createElement(f.A,{variant:"text",onClick:s},E)};function Q(e){try{const a=e.getString("field"),n=e.getString("operator"),r=J(e);return(0,A.i)(n)&&r!==void 0?{field:a,operator:n,value:r}:void 0}catch{return}}function J(e){let a;try{a=e.getString("value")}catch{try{a=e.getNumber("value")}catch{}}return a}function S(e){try{return e.map(Q).filter(Boolean)}catch{return}}const X=(0,y.A)(e=>({name:{marginLeft:"0.8rem",marginRight:"0.8rem"}})),Y=({visit:e})=>{const a=X();return t.createElement(_.A,{component:B.N_,to:e.pathname,noWrap:!0,className:a.name},e.name)},Z=({visit:e})=>t.createElement(_.A,{component:"span",variant:"caption",color:"textSecondary"},e.hits," time",e.hits>1?"s":""),b=({visit:e})=>{var a;const n=K.c9.fromMillis(e.timestamp);return t.createElement(_.A,{component:"time",variant:"caption",color:"textSecondary",dateTime:(a=n.toISO())!=null?a:void 0},n>=K.c9.now().startOf("day")?n.toFormat("HH:mm"):n.toRelative())},w=({visit:e,type:a})=>a==="time-ago"?t.createElement(b,{visit:e}):t.createElement(Z,{visit:e}),q=(0,y.A)(e=>({chip:{color:e.palette.common.white,fontWeight:"bold",margin:0}})),ee=e=>{var a;try{return(0,$.KU)((a=e==null?void 0:e.entityRef)!=null?a:"")}catch{return}},F=e=>{const a=Object.keys(W.kW),n=e%a.length;return W.kW[a[n]][0]},te=e=>{const a=F(0);if(!e)return a;const r=["component","template","api","group","user","resource","system","domain","location"].indexOf(e.kind.toLocaleLowerCase("en-US"));return r===-1?a:F(r+1)},ne=({visit:e})=>{var a;const n=q(),r=ee(e);return t.createElement(P.A,{size:"small",className:n.chip,label:((a=r==null?void 0:r.kind)!=null?a:"Other").toLocaleLowerCase("en-US"),style:{background:te(r)}})},ae=(0,y.A)(e=>({avatar:{minWidth:0}})),T=({visit:e,detailType:a})=>{const n=ae();return t.createElement(D.A,{disableGutters:!0},t.createElement(M.A,{className:n.avatar},t.createElement(ne,{visit:e})),t.createElement(h.A,{primary:t.createElement(Y,{visit:e}),secondary:t.createElement(w,{visit:e,type:a}),disableTypography:!0}))},re=()=>t.createElement(t.Fragment,null,t.createElement(_.A,{variant:"body2",color:"textSecondary"},"There are no visits to show yet."),t.createElement(_.A,{variant:"body2",color:"textSecondary"},"Once you start using Backstage, your visits will appear here as a quick link to carry on where you left off.")),oe=()=>t.createElement(t.Fragment,null,t.createElement(_.A,{variant:"body2",color:"textSecondary"},"The more pages you visit, the more pages will appear here.")),le=(0,y.A)(e=>({skeleton:{borderRadius:30}})),N=()=>{const e=le();return t.createElement(D.A,{disableGutters:!0},t.createElement(M.A,null,t.createElement(U.A,{className:e.skeleton,variant:"rect",width:50,height:24})),t.createElement(h.A,{primary:t.createElement(U.A,{variant:"text",width:"100%",height:28}),disableTypography:!0}))},se=({numVisitsOpen:e,numVisitsTotal:a,collapsed:n})=>t.createElement(t.Fragment,null,Array(e).fill(null).map((r,l)=>t.createElement(N,{key:l})),a>e&&t.createElement(L.A,{in:!n},Array(a-e).fill(null).map((r,l)=>t.createElement(N,{key:l})))),ie=(0,y.A)(e=>({title:{marginBottom:"2rem"}})),ce=({title:e,detailType:a,visits:n=[],numVisitsOpen:r=3,numVisitsTotal:l=8,collapsed:s=!0,loading:E=!1})=>{const u=ie();let c=t.createElement(t.Fragment,null);return E?c=t.createElement(se,{numVisitsOpen:r,numVisitsTotal:l,collapsed:s}):n.length===0?c=t.createElement(re,null):n.length<r?c=t.createElement(t.Fragment,null,n.map((i,d)=>t.createElement(T,{visit:i,key:d,detailType:a})),t.createElement(oe,null)):c=t.createElement(t.Fragment,null,n.slice(0,r).map((i,d)=>t.createElement(T,{visit:i,key:d,detailType:a})),n.length>r&&t.createElement(L.A,{in:!s},n.slice(r,l).map((i,d)=>t.createElement(T,{visit:i,key:d,detailType:a})))),t.createElement(t.Fragment,null,t.createElement(_.A,{variant:"h5",className:u.title},e),t.createElement(R.A,{dense:!0,disablePadding:!0},c))},me=()=>{const{collapsed:e,numVisitsOpen:a,numVisitsTotal:n,visits:r,loading:l,kind:s}=I();return t.createElement(ce,{visits:r,title:s==="top"?"Top Visited":"Recently Visited",detailType:s==="top"?"hits":"time-ago",collapsed:e,numVisitsOpen:a,numVisitsTotal:n,loading:l})},Ee=({visits:e,numVisitsOpen:a,numVisitsTotal:n,loading:r,kind:l})=>{const{setContext:s,setVisits:E,setLoading:u}=I();(0,t.useEffect)(()=>{const m={};m.kind=l,e?(m.visits=e,m.loading=!1):r&&(m.loading=r),a&&(m.numVisitsOpen=a),n&&(m.numVisitsTotal=n),s(g=>({...g,...m}))},[s,l,e,r,a,n]);const c=(0,p.u)(p.p),i=(0,p.u)(A.v),{loading:d}=(0,H.default)(async()=>{var m,g;if(!e&&!r&&l==="recent"){const O=S((m=c.getOptionalConfigArray("home.recentVisits.filterBy"))!=null?m:[]);return await i.list({limit:n!=null?n:8,orderBy:[{field:"timestamp",direction:"desc"}],...O&&{filterBy:O}}).then(E)}if(!e&&!r&&l==="top"){const O=S((g=c.getOptionalConfigArray("home.topVisits.filterBy"))!=null?g:[]);return await i.list({limit:n!=null?n:8,orderBy:[{field:"hits",direction:"desc"}],...O&&{filterBy:O}}).then(E)}},[i,e,r,E]);return(0,t.useEffect)(()=>{r||u(d)},[r,u,d]),t.createElement(me,null)}},24858:(j,v,o)=>{o.r(v),o.d(v,{Actions:()=>t.A,Content:()=>A,ContextProvider:()=>t.a});var t=o(43889),f=o(14041),y=o(45833),_=o.n(y),P=o(45250),D=o.n(P),M=o(43157),h=o(94384),L=o(94403),R=o(52950);const A=B=>f.createElement(t.C,{...B,kind:"recent"})}}]);})();

//# sourceMappingURL=4858.6cdf0d47.chunk.js.map